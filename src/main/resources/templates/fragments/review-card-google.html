<!doctype html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<body>
<div th:fragment="card" class="bg-white rounded-2xl shadow p-4">
    <div class="flex items-start justify-between">
        <div>
            <h3 class="text-lg font-semibold">An√°lisis (Google Play)</h3>
            <p class="text-sm text-slate-500" th:text="${#dates.createNow()}">Fecha y hora</p>
        </div>

        <!-- Sentiment pill -->
        <span th:classappend="${result.sentiment.name() == 'NEGATIVE'} ? ' bg-rose-100 text-rose-700' :
                            (${result.sentiment.name() == 'POSITIVE'} ? ' bg-emerald-100 text-emerald-700' :
                            ' bg-amber-100 text-amber-700')"
              class="inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold">
        <span th:text="${result.sentiment}">SENTIMENT</span>
      </span>
    </div>

    <!-- Texto de la review -->
    <div class="mt-3 border border-slate-200 rounded-xl p-3 bg-slate-50">
        <p class="text-sm text-slate-700">
            <span class="font-medium">Review:</span>
            <span th:text="${originalReview}">Texto de la review...</span>
        </p>
    </div>

    <!-- Metadatos Google -->
    <div class="mt-3 text-xs text-slate-600 flex flex-wrap gap-x-4 gap-y-1" th:if="${googleMeta != null}">
      <span th:if="${googleMeta.starRating != null}">
        ‚òÖ <span th:text="${googleMeta.starRating}">1</span>/5
      </span>
        <span th:if="${googleMeta.appVersionName != null}">
        v<span th:text="${googleMeta.appVersionName}">12.3.0</span>
      </span>
        <span th:if="${googleMeta.androidOsVersion != null}">
        SDK <span th:text="${googleMeta.androidOsVersion}">34</span>
      </span>
        <span th:if="${googleMeta.device != null}">
        Device: <span th:text="${googleMeta.device}">flounder</span>
      </span>
        <span th:if="${googleMeta.thumbsUpCount != null}">
        üëç <span th:text="${googleMeta.thumbsUpCount}">42</span>
      </span>
        <span th:if="${googleMeta.thumbsDownCount != null}">
        üëé <span th:text="${googleMeta.thumbsDownCount}">3</span>
      </span>
        <span th:if="${googleMeta.reviewerLanguage != null}">
        Lang: <span th:text="${googleMeta.reviewerLanguage}">es</span>
      </span>
    </div>

    <!-- Resumen & Severidad -->
    <div class="mt-3">
        <p class="text-sm text-slate-600">
            <span class="font-medium">Resumen:</span>
            <span th:text="${result.summary}">Resumen‚Ä¶</span>
        </p>
    </div>

    <div class="mt-3 flex flex-wrap gap-2 items-center">
        <span class="text-sm font-medium text-slate-600">Severidad:</span>
        <span th:classappend="${result.severity.name() == 'CRITICAL'} ? ' bg-rose-600 text-white' :
                            (${result.severity.name() == 'HIGH'} ? ' bg-rose-200 text-rose-900' :
                            (${result.severity.name() == 'MEDIUM'} ? ' bg-amber-200 text-amber-900' :
                            ' bg-emerald-200 text-emerald-900'))"
              class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-semibold"
              th:text="${result.severity}">
        HIGH
      </span>

        <span th:if="${result.escalated}"
              class="ml-2 text-xs px-2.5 py-0.5 rounded-full font-semibold bg-indigo-600 text-white">
        ESCALADO
      </span>
    </div>

    <!-- Acciones -->
    <div class="mt-4">
        <p class="text-sm font-medium text-slate-700 mb-2">Acciones recomendadas:</p>
        <ul class="list-disc list-inside space-y-1"
            th:if="${result.recommendedActions != null and !#lists.isEmpty(result.recommendedActions)}">
            <li class="text-sm text-slate-700" th:each="act : ${result.recommendedActions}" th:text="${act}">Acci√≥n</li>
        </ul>
        <p class="text-sm text-slate-500" th:if="${result.recommendedActions == null or #lists.isEmpty(result.recommendedActions)}">
            No se requieren acciones.
        </p>
    </div>
</div>
</body>
</html>
